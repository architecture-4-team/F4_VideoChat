<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        body {
            background-color: #000000;
            color: #FFFFFF;
            font-family: Arial, sans-serif;
        }

        a {
            color: #FFFFFF;
            text-decoration: none;
        }

        h1 {
            color: #FFFFFF;
            text-align: center;
        }

        p {
            color: #FFFFFF;
            text-align: center;
        }

        /* 추가적인 요소들을 블랙 테마로 스타일링할 수 있습니다. */
    </style>
    <script>
        function sendMessage() {
            window.chrome.webview.postMessage("loading_complete");
        };

        var uiServerAddress = "";
        var count = 0;
        var time_wait = 0;

        function pingServer() {
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200) {
                        document.getElementById("status").textContent = "Server is available.";
                        window.location.href = uiServerAddress.concat("/login");
                    } else {
                        document.getElementById("status").textContent = "Try to access server. Wait please.";

                        // wait 10sec
                        //                        window.chrome.webview.postMessage("server_fail");

                        setTimeout(function () {
                            window.chrome.webview.postMessage("server_fail");
                            document.getElementById("count").textContent = "Retry counts : " + count;
                            count += 1;
                        }, 1000);
                    }
                }
            };
            xhr.open("GET", uiServerAddress, true);
            xhr.send();
        };

        window.chrome.webview.addEventListener('message', arg => {
            pingServer();
            if (arg.data !== "try_again") {
                uiServerAddress = arg.data;
            }
        });

        window.onload = sendMessage;
    </script>
</head>
<body>
    <h1>Check UI Server status...</h1>
    <p id="status"></p>
    <p id="count"></p>
</body>
</html>